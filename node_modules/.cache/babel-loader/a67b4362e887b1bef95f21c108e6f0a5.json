{"remainingRequest":"D:\\epub_\\node_modules\\babel-loader\\lib\\index.js!D:\\epub_\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!D:\\epub_\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\epub_\\src\\views\\book.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\epub_\\src\\views\\book.vue","mtime":1597809038574},{"path":"D:\\epub_\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\epub_\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"D:\\epub_\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\epub_\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuaW5kZXgtb2YiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5kYXRlLnRvLXN0cmluZyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnBhcnNlLWludCI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnJlZ2V4cC5leGVjIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc3RyaW5nLnNwbGl0IjsKaW1wb3J0ICJ2YW50L2VzL25hdi1iYXIvc3R5bGUiOwppbXBvcnQgX05hdkJhciBmcm9tICJ2YW50L2VzL25hdi1iYXIiOwppbXBvcnQgInZhbnQvZXMvbG9hZGluZy9zdHlsZSI7CmltcG9ydCBfTG9hZGluZyBmcm9tICJ2YW50L2VzL2xvYWRpbmciOwppbXBvcnQgInZhbnQvZXMvY2FyZC9zdHlsZSI7CmltcG9ydCBfQ2FyZCBmcm9tICJ2YW50L2VzL2NhcmQiOwppbXBvcnQgInZhbnQvZXMvcmFkaW8tZ3JvdXAvc3R5bGUiOwppbXBvcnQgX1JhZGlvR3JvdXAgZnJvbSAidmFudC9lcy9yYWRpby1ncm91cCI7CmltcG9ydCAidmFudC9lcy9yYWRpby9zdHlsZSI7CmltcG9ydCBfUmFkaW8gZnJvbSAidmFudC9lcy9yYWRpbyI7CmltcG9ydCAidmFudC9lcy9jZWxsLWdyb3VwL3N0eWxlIjsKaW1wb3J0IF9DZWxsR3JvdXAgZnJvbSAidmFudC9lcy9jZWxsLWdyb3VwIjsKaW1wb3J0ICJ2YW50L2VzL2NlbGwvc3R5bGUiOwppbXBvcnQgX0NlbGwgZnJvbSAidmFudC9lcy9jZWxsIjsKaW1wb3J0ICJ2YW50L2VzL3RhYnMvc3R5bGUiOwppbXBvcnQgX1RhYnMgZnJvbSAidmFudC9lcy90YWJzIjsKaW1wb3J0ICJ2YW50L2VzL3RhYi9zdHlsZSI7CmltcG9ydCBfVGFiIGZyb20gInZhbnQvZXMvdGFiIjsKaW1wb3J0ICJ2YW50L2VzL3BvcHVwL3N0eWxlIjsKaW1wb3J0IF9Qb3B1cCBmcm9tICJ2YW50L2VzL3BvcHVwIjsKaW1wb3J0ICJ2YW50L2VzL3Byb2dyZXNzL3N0eWxlIjsKaW1wb3J0IF9Qcm9ncmVzcyBmcm9tICJ2YW50L2VzL3Byb2dyZXNzIjsKaW1wb3J0ICJ2YW50L2VzL3Jvdy9zdHlsZSI7CmltcG9ydCBfUm93IGZyb20gInZhbnQvZXMvcm93IjsKaW1wb3J0ICJ2YW50L2VzL2NvbC9zdHlsZSI7CmltcG9ydCBfQ29sIGZyb20gInZhbnQvZXMvY29sIjsKaW1wb3J0ICJ2YW50L2VzL3NsaWRlci9zdHlsZSI7CmltcG9ydCBfU2xpZGVyIGZyb20gInZhbnQvZXMvc2xpZGVyIjsKaW1wb3J0ICJ2YW50L2VzL3N0ZXBwZXIvc3R5bGUiOwppbXBvcnQgX1N0ZXBwZXIgZnJvbSAidmFudC9lcy9zdGVwcGVyIjsKaW1wb3J0ICJ2YW50L2VzL2ltYWdlL3N0eWxlIjsKaW1wb3J0IF9JbWFnZSBmcm9tICJ2YW50L2VzL2ltYWdlIjsKaW1wb3J0IGJvb2ttZW51IGZyb20gJ0AvY29tcG9uZW50cy9ib29rbWVudSc7CmltcG9ydCBWdWUgZnJvbSAndnVlJzsKaW1wb3J0IEVwdWIgZnJvbSAnZXB1YmpzJzsKaW1wb3J0IGF4aW9zIGZyb20gJ2F4aW9zJzsKVnVlLnVzZShfTmF2QmFyKS51c2UoX0xvYWRpbmcpLnVzZShfQ2FyZCkudXNlKF9SYWRpb0dyb3VwKS51c2UoX1JhZGlvKS51c2UoX0NlbGxHcm91cCkudXNlKF9DZWxsKS51c2UoX1RhYnMpLnVzZShfVGFiKS51c2UoX1BvcHVwKS51c2UoX1Byb2dyZXNzKS51c2UoX1JvdykudXNlKF9Db2wpLnVzZShfU2xpZGVyKS51c2UoX1N0ZXBwZXIpLnVzZShfSW1hZ2UpOwp2YXIgYm9vaywgcmVuZGl0aW9uOwpleHBvcnQgZGVmYXVsdCB7CiAgbmFtZTogJ2Jvb2snLAogIGNvbXBvbmVudHM6IHsKICAgIGJvb2ttZW51OiBib29rbWVudQogIH0sCiAgZGF0YTogZnVuY3Rpb24gZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIHB1YmxpY1BhdGg6IHByb2Nlc3MuZW52LkJBU0VfVVJMLAogICAgICBib29rOiBudWxsLAogICAgICBiZWdpbkJhc2VQYWdlOiAyLAogICAgICBwYWdlVGV4dDogIiIsCiAgICAgIHBhZ2VQcm9jZXNzOiAwLAogICAgICBjdXJyZW50UGFnZTogMSwKICAgICAgY3VycmVudENoYXBlcklkeDogMiwKICAgICAgcmVuZGl0aW9uOiBudWxsLAogICAgICBjaGFwdGVyOiB7fSwKICAgICAgY2hhbmdlVHlwZTogIm1lbnUiLAogICAgICBmaXJzdExvYWQ6IHRydWUsCiAgICAgIGxvYWRpbmc6IHRydWUsCiAgICAgIHBvcHVwU2hvdzogZmFsc2UsCiAgICAgIHNob3dMZWZ0RHJhd2VyOiBmYWxzZSwKICAgICAgbGlnaHQ6IDEwMCwKICAgICAgbG9jYXRpb25Mb2FkaW5nOiB0cnVlLAogICAgICBmaXJzdExvYWRpbmc6IHRydWUsCiAgICAgIG1hc2tGbGFnOiBmYWxzZSwKICAgICAgZXJyb3JNYXNrVGV4dDogIiIsCiAgICAgIGZvbnRTaXplOiAxNCwKICAgICAgYmFja0ltYWdlOiAiIiwKICAgICAgdG9jOiBbXSwKICAgICAgYmFja0ltYWdlTGlzdDogW3sKICAgICAgICBjbGFzczogImJnLXRpbWciLAogICAgICAgIGJhY2tJbWFnZXNyYzogInJlYWRlckltYWdlcy90aW1nX2JpZy5qcGciCiAgICAgIH0sIHsKICAgICAgICBjbGFzczogImJnLXRpbWcxIiwKICAgICAgICBiYWNrSW1hZ2VzcmM6ICJyZWFkZXJJbWFnZXMvdGltZzFfYmlnLmpwZyIKICAgICAgfSwgewogICAgICAgIGNsYXNzOiAiYmctdGltZzMiLAogICAgICAgIGJhY2tJbWFnZXNyYzogInJlYWRlckltYWdlcy90aW1nM19iaWcuanBnIgogICAgICB9LCB7CiAgICAgICAgY2xhc3M6ICJiZy10aW1nNCIsCiAgICAgICAgYmFja0ltYWdlc3JjOiAiIgogICAgICB9XSwKICAgICAgcmVhZGVyU3R5bGU6IHsKICAgICAgICBsaWdodDogMTAwLAogICAgICAgIGZvbnRTaXplOiAxNCwKICAgICAgICBiYWNrSW1hZ2U6ICIiCiAgICAgIH0sCiAgICAgIHBhZ2VBbmltYXRpb25DbGFzczogIiIsCiAgICAgIGNvdmVyaW1nOiAiIiwKICAgICAgbXFsOiAiIiwKICAgICAgbXFsRmxhZ2U6IGZhbHNlCiAgICB9OwogIH0sCiAgd2F0Y2g6IHsKICAgIHRvYzogewogICAgICBoYW5kbGVyOiBmdW5jdGlvbiBoYW5kbGVyKG9sZFZhbCwgbmV3VmFsKSB7Ly8gY29uc29sZS5sb2cobmV3VmFsKQogICAgICB9LAogICAgICBkZWVwOiB0cnVlCiAgICB9LAogICAgY2hhcHRlcjogZnVuY3Rpb24gY2hhcHRlcih2YWwpIHsKICAgICAgaWYgKHRoaXMuY2hhbmdlVHlwZSA9PSAibWVudSIpIHJlbmRpdGlvbi5kaXNwbGF5KHZhbC5ocmVmKTsKICAgIH0sCiAgICBmb250U2l6ZTogZnVuY3Rpb24gZm9udFNpemUodmFsKSB7CiAgICAgIHRoaXMub25Gb250U2l6ZUNoYW5nZSh2YWwpOwogICAgfSwKICAgIGxpZ2h0OiBmdW5jdGlvbiBsaWdodCh2YWwpIHsKICAgICAgdGhpcy5vbkxpZ2h0Q2hhbmdlKHZhbCk7CiAgICB9LAogICAgYmFja0ltYWdlOiBmdW5jdGlvbiBiYWNrSW1hZ2UodmFsKSB7CiAgICAgIHRoaXMub25CYWNrSW1hZ2VDaGFuZ2UodmFsKTsKICAgIH0sCiAgICBtcWw6IGZ1bmN0aW9uIG1xbCh2YWwpIHsKICAgICAgdGhpcy5tcWwgPSB2YWw7CiAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKCJtcWwiLCB0aGlzLm1xbCk7CiAgICB9CiAgfSwKICBtZXRob2RzOiB7CiAgICAvLyDngrnlh7vkuIvkuIDpobUKICAgIG5leHRQYWdlOiBmdW5jdGlvbiBuZXh0UGFnZSgpIHsKICAgICAgcmVuZGl0aW9uLm5leHQoKTsKICAgIH0sCiAgICAvLyDngrnlh7vkuIrkuIDpobUKICAgIHByZXZQYWdlOiBmdW5jdGlvbiBwcmV2UGFnZSgpIHsKICAgICAgaWYgKHRoaXMuY3VycmVudFBhZ2UgPT0gMSAmJiBib29rLnBhY2thZ2UubWV0YWRhdGEuZGlyZWN0aW9uICE9ICJydGwiICYmIHRoaXMuY3VycmVudENoYXBlcklkeCA8PSAyKSByZXR1cm47IC8v56ys5LiA6aG156aB5q2i57un57ut5ZCR5YmNCgogICAgICByZW5kaXRpb24ucHJldigpOwogICAgfSwKICAgIG9uQ2xpY2tMZWZ0OiBmdW5jdGlvbiBvbkNsaWNrTGVmdCgpIHsKICAgICAgd2luZG93Lmhpc3RvcnkuYmFjaygtMSk7IC8vIGJvb2sKICAgIH0sCiAgICBvbkNsaWNrUmlnaHQ6IGZ1bmN0aW9uIG9uQ2xpY2tSaWdodCgpIHsKICAgICAgdGhpcy5zaG93TGVmdERyYXdlciA9IHRydWU7CiAgICB9LAogICAgb25MaWdodENoYW5nZTogZnVuY3Rpb24gb25MaWdodENoYW5nZSh2YWwpIHsKICAgICAgdmFyIG92ZXJsYXkgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgicmVhZGVyLW92ZXJsYXkiKTsKICAgICAgb3ZlcmxheS5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSAicmdiYSgwLDAsMCwiICsgKDAuNSAtIHZhbCAvIDIwMCkgKyAiKSI7CiAgICAgIHRoaXMucmVhZGVyU3R5bGUubGlnaHQgPSB2YWw7CiAgICB9LAogICAgb25Gb250U2l6ZUNoYW5nZTogZnVuY3Rpb24gb25Gb250U2l6ZUNoYW5nZSh2YWwpIHsKICAgICAgLy8g5Yik5pat5qiq5bGP56uW5bGP5bGV56S65LiN5ZCM5a2X5L2T5aSn5bCPCiAgICAgIHZhciBtcWwgPSB3aW5kb3cubWF0Y2hNZWRpYSgiKG9yaWVudGF0aW9uOiBwb3J0cmFpdCkiKTsKCiAgICAgIGlmIChtcWwubWF0Y2hlcykgewogICAgICAgIC8vIOerluWxjwogICAgICAgIC8vIHRoaXMuZm9udFNpemUgPSAxNTsKICAgICAgICAvLyB0aGlzLnJlYWRlclN0eWxlLmZvbnRTaXplID0gMTU7CiAgICAgICAgdGhpcy5tcWwgPSAiMCI7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgLy8g5qiq5bGPCiAgICAgICAgLy8gdGhpcy5mb250U2l6ZSA9IDIyOwogICAgICAgIC8vIHRoaXMucmVhZGVyU3R5bGUuZm9udFNpemUgPSAyMjsKICAgICAgICB0aGlzLm1xbCA9ICIxIjsKICAgICAgfQoKICAgICAgdmFyIGlmcmFtZURvYyA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKCJpZnJhbWUiKVswXS5jb250ZW50V2luZG93LmRvY3VtZW50OwogICAgICB2YXIgZm9udFNpemVTdHlsZSA9IGlmcmFtZURvYy5nZXRFbGVtZW50QnlJZCgiZm9udFNpemUiKTsKCiAgICAgIGlmICghZm9udFNpemVTdHlsZSkgewogICAgICAgIGZvbnRTaXplU3R5bGUgPSBpZnJhbWVEb2MuY3JlYXRlRWxlbWVudCgnc3R5bGUnKTsKICAgICAgICBmb250U2l6ZVN0eWxlLmlkID0gImZvbnRTaXplIjsKICAgICAgICBmb250U2l6ZVN0eWxlLnR5cGUgPSAndGV4dC9jc3MnOwogICAgICAgIGZvbnRTaXplU3R5bGUuaW5uZXJIVE1MID0gInAsZGl2eyBmb250LXNpemU6IiArIHZhbCArICJweCB9IjsKICAgICAgICBpZnJhbWVEb2MuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ0hFQUQnKS5pdGVtKDApLmFwcGVuZENoaWxkKGZvbnRTaXplU3R5bGUpOwogICAgICB9IGVsc2UgewogICAgICAgIGZvbnRTaXplU3R5bGUuaW5uZXJIVE1MID0gInAsZGl2eyBmb250LXNpemU6IiArIHZhbCArICJweCB9IjsKICAgICAgfQoKICAgICAgaWYgKHRoaXMucmVhZGVyU3R5bGUuZm9udFNpemUgIT0gdmFsKSB7CiAgICAgICAgdGhpcy5yZWFkZXJTdHlsZS5mb250U2l6ZSA9IHZhbDsgLy8gdGhpcy5sb2NhdGlvbkxvYWRpbmcgPSB0cnVlOwogICAgICAgIC8vIGxldCB0aGF0ID0gdGhpczsKICAgICAgICAvLyBib29rLmxvY2F0aW9ucy5nZW5lcmF0ZSg2NjYpLnRoZW4oZnVuY3Rpb24obG9jYXRpb24pIHsgLy8gVGhpcyBwcm9taXNlIHdpbGwgdGFrZSBhIGxpdHRsZSB3aGlsZSB0byByZXR1cm4gKEFib3V0IDIwIHNlY29uZHMgb3Igc28gZm9yIE1vYnkgRGljaykKICAgICAgICAvLyAgICAgdGhhdC5sb2NhdGlvbkxvYWRpbmcgPSBmYWxzZTsKICAgICAgICAvLyAgICAgdGhhdC5wYWdlVGV4dCA9ICh0aGF0LmJlZ2luQmFzZVBhZ2UgKyB0aGF0LmN1cnJlbnRQYWdlKSArICIvIiArIGJvb2subG9jYXRpb25zLnRvdGFsOwogICAgICAgIC8vIH0pOwogICAgICB9CiAgICB9LAogICAgb25CYWNrSW1hZ2VDaGFuZ2U6IGZ1bmN0aW9uIG9uQmFja0ltYWdlQ2hhbmdlKHZhbCkgewogICAgICB2YXIgaWZyYW1lRG9jID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoImlmcmFtZSIpWzBdLmNvbnRlbnRXaW5kb3cuZG9jdW1lbnQ7CiAgICAgIHZhciBiZG95ID0gaWZyYW1lRG9jLmdldEVsZW1lbnRzQnlUYWdOYW1lKCJib2R5IilbMF07CiAgICAgIGJkb3kuc3R5bGUuYmFja2dyb3VuZEltYWdlID0gdmFsOwogICAgICB0aGlzLnJlYWRlclN0eWxlLmJhY2tJbWFnZSA9IHZhbDsKICAgIH0sCiAgICBjaGFuZ2VCYWNrSW1hZ2U6IGZ1bmN0aW9uIGNoYW5nZUJhY2tJbWFnZSh2YWx1ZSkgewogICAgICBpZiAodmFsdWUuYmFja0ltYWdlc3JjKSB0aGlzLmJhY2tJbWFnZSA9ICJ1cmwoJyIgKyB0aGlzLnB1YmxpY1BhdGggKyB2YWx1ZS5iYWNrSW1hZ2VzcmMgKyAiJykiO2Vsc2UgdGhpcy5iYWNrSW1hZ2UgPSAiIjsKICAgIH0sCiAgICB1cGRhdGVTdHlsZTogZnVuY3Rpb24gdXBkYXRlU3R5bGUoKSB7CiAgICAgIHRoaXMub25MaWdodENoYW5nZSh0aGlzLnJlYWRlclN0eWxlLmxpZ2h0KTsKICAgICAgdGhpcy5vbkJhY2tJbWFnZUNoYW5nZSh0aGlzLnJlYWRlclN0eWxlLmJhY2tJbWFnZSk7CiAgICAgIHRoaXMub25Gb250U2l6ZUNoYW5nZSh0aGlzLnJlYWRlclN0eWxlLmZvbnRTaXplKTsKICAgIH0sCiAgICBjaGFuZ2VDaGFwdGVyOiBmdW5jdGlvbiBjaGFuZ2VDaGFwdGVyKGNoYXB0ZXIpIHsKICAgICAgdGhpcy5jaGFuZ2VUeXBlID0gIm1lbnUiOwogICAgICB0aGlzLnNob3dMZWZ0RHJhd2VyID0gZmFsc2U7CiAgICAgIHRoaXMuY2hhcHRlciA9IGNoYXB0ZXI7CiAgICB9CiAgfSwKICBiZWZvcmVDcmVhdGU6IGZ1bmN0aW9uIGJlZm9yZUNyZWF0ZSgpIHsKICAgIC8vIGFqYXgoKSAgCiAgICBkb2N1bWVudC50aXRsZSA9ICLlm77kuabpmIXor7siOwogICAgdmFyIHRoYXQgPSB0aGlzOwogICAgdmFyIGJvb2tmaWxlID0gdGhpcy4kcm91dGUucGFyYW1zLnBhdGhNYXRjaDsKICAgIHZhciBwYXJhbVZhbHVlID0gYm9va2ZpbGUuc3BsaXQoIi8iKTsKCiAgICBpZiAocGFyYW1WYWx1ZS5sZW5ndGggPCAzKSB7CiAgICAgIHRoYXQuJG5leHRUaWNrKGZ1bmN0aW9uICgpIHsKICAgICAgICB0aGF0Lm1hc2tGbGFnID0gdHJ1ZTsgLy90b2RvIOWPguaVsOmUmeivrwoKICAgICAgICB0aGF0LmVycm9yTWFza1RleHQgPSAi5Y+C5pWw6ZSZ6K+vIjsKICAgICAgfSk7CiAgICAgIHJldHVybjsKICAgIH0KCiAgICB2YXIgdG9rZW4gPSBwYXJhbVZhbHVlWzJdOwoKICAgIGlmICh0b2tlbi5pbmRleE9mKCJ0PSIpID09IC0xKSB7CiAgICAgIC8v5qCh6aqMdG9rZW4gICJodHRwczovL2RhdGEubGlsdW4uY24vUkVTVC9hcGkvY2hlY2tlcHViVG9rZW4vdG9rZW49IiArIHRva2VuCiAgICAgIGF4aW9zLmdldCgiaHR0cDovLzE5Mi4xNjguMS4yMTg6ODA4MC9SRVNUL2FwaS9jaGVja2VwdWJUb2tlbj90b2tlbj0iICsgdG9rZW4pLnRoZW4oZnVuY3Rpb24gKHJlcykgewogICAgICAgIGlmICghcmVzKSB7CiAgICAgICAgICB0aGF0LiRuZXh0VGljayhmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgIHRoYXQubWFza0ZsYWcgPSB0cnVlOwogICAgICAgICAgICB0aGF0LmVycm9yTWFza1RleHQgPSAi5peg5pWIdG9rZW4iOwogICAgICAgICAgfSk7CiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICB9KTsKICAgIH0KCiAgICBib29rZmlsZSA9IHBhcmFtVmFsdWVbMF0gKyAiLyIgKyBwYXJhbVZhbHVlWzFdOwogICAgdmFyIGJvb2tvcHRpb24gPSB7fTsKCiAgICBpZiAoIS8uZXB1YiQvLnRlc3QoYm9va2ZpbGUpICYmIGJvb2tmaWxlICE9IHVuZGVmaW5lZCkgewogICAgICBib29rb3B0aW9uLm9wZW5BcyA9ICdkaXJlY3RvcnknOwogICAgfQoKICAgIGJvb2sgPSBuZXcgRXB1Yihib29rZmlsZSwgYm9va29wdGlvbik7CiAgICByZW5kaXRpb24gPSBib29rLnJlbmRlclRvKCJ2aWV3ZXIiLCB7CiAgICAgIHdpZHRoOiAiMTAwJSIKICAgIH0pOwogICAgYm9vay5yZWFkeS50aGVuKGZ1bmN0aW9uICgpIHsKICAgICAgdGhhdC5jb3ZlcmltZyA9IGJvb2suY292ZXI7CiAgICAgIHJldHVybiBib29rLmxvY2F0aW9ucy5nZW5lcmF0ZSg3MTkpOyAvLyBHZW5lcmF0ZXMgQ0ZJIGZvciBldmVyeSBYIGNoYXJhY3RlcnMgKENoYXJhY3RlcnMgcGVyL3BhZ2UpCiAgICAgIC8vIH0KICAgIH0pLnRoZW4oZnVuY3Rpb24gKGxvY2F0aW9ucykgewogICAgICAvLyBUaGlzIHByb21pc2Ugd2lsbCB0YWtlIGEgbGl0dGxlIHdoaWxlIHRvIHJldHVybiAoQWJvdXQgMjAgc2Vjb25kcyBvciBzbyBmb3IgTW9ieSBEaWNrKQogICAgICB0aGF0LmxvY2F0aW9uTG9hZGluZyA9IGZhbHNlOwogICAgICB2YXIgbG9jYXRpb24gPSB2aWV3TWFuYWdlci5jdXJyZW50TG9jYXRpb24oKTsKICAgICAgdmFyIHAgPSBsb2NhdGlvblswXS5wYWdlc1swXTsKICAgICAgdGhhdC5wYWdlVGV4dCA9IHRoYXQuYmVnaW5CYXNlUGFnZTsKICAgICAgdGhhdC5wYWdlQW5pbWF0aW9uQ2xhc3MgPSAiIjsKICAgICAgdGhhdC5iZWdpbkJhc2VQYWdlID0gdGhhdC5iZWdpbkJhc2VQYWdlIC0gcDsKICAgIH0pOwogICAgdmFyIHZpZXdNYW5hZ2VyOwogICAgcmVuZGl0aW9uLm9uKCJzdGFydGVkIiwgZnVuY3Rpb24gKCkgewogICAgICB2aWV3TWFuYWdlciA9IHJlbmRpdGlvbi5tYW5hZ2VyOwogICAgICB2aWV3TWFuYWdlci5vbigiYmVmb3JlQ3JlYXRlVmlldyIsIGZ1bmN0aW9uIChzZWN0aW9uKSB7CiAgICAgICAgdGhhdC5sb2FkaW5nID0gdHJ1ZTsKICAgICAgfSk7CiAgICAgIHZpZXdNYW5hZ2VyLm9uKCJhZnRlckNyZWF0ZVZpZXciLCBmdW5jdGlvbiAodmlldykgewogICAgICAgIHZpZXcuaG9va3MuY29udGVudC5yZWdpc3RlcihmdW5jdGlvbiAoaWZyYW1lKSB7CiAgICAgICAgICB0aGF0LnVwZGF0ZVN0eWxlKCk7CiAgICAgICAgfSk7CiAgICAgIH0pOwogICAgfSk7CiAgICByZW5kaXRpb24ub24oInJlbmRlcmVkIiwgZnVuY3Rpb24gKHNlY3Rpb24pIHsKICAgICAgaWYgKHZpZXdNYW5hZ2VyLmN1cnJlbnRMb2NhdGlvbigpWzBdLnBhZ2VzLmxlbmd0aCA+PSAyKSB7CiAgICAgICAgdGhhdC5tcWxGbGFnZSA9ICF0aGF0Lm1xbEZsYWdlOwogICAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKCJtcWwiLCAiMSIpOwogICAgICB9IGVsc2UgewogICAgICAgIHRoYXQubXFsRmxhZ2UgPSBmYWxzZTsKICAgICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgibXFsIiwgIjAiKTsKICAgICAgfSAvLyBtcWxGbGFnZQoKCiAgICAgIGlmICghdGhhdC5sb2NhdGlvbkxvYWRpbmcpIHsKICAgICAgICB2YXIgbG9jYXRpb24gPSB2aWV3TWFuYWdlci5jdXJyZW50TG9jYXRpb24oKTsKICAgICAgICB2YXIgcCA9IGxvY2F0aW9uWzBdLnBhZ2VzWzBdOwogICAgICAgIHRoYXQuYmVnaW5CYXNlUGFnZSA9IGJvb2subG9jYXRpb25zLmxvY2F0aW9uRnJvbUNmaShyZW5kaXRpb24uY3VycmVudExvY2F0aW9uKCkuc3RhcnQuY2ZpKSAtIHA7CiAgICAgIH0KCiAgICAgIGlmICh0aGF0LmZpcnN0TG9hZGluZykgewogICAgICAgIC8vbG9jYXRpb27vvIjkuLrkuobliIbpobXnmoTpobXnoIHorqHnrpfvvIkg6L+Y5Zyo6K6h566X5Lit55qE6K+d77yM56iN562J5LiA5Lya5YS/5Zyo5YWz6ZetbG9hZGluZ+mhtemdogogICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkgewogICAgICAgICAgdGhhdC5sb2FkaW5nID0gZmFsc2U7CiAgICAgICAgICB0aGF0LmZpcnN0TG9hZGluZyA9IGZhbHNlOwogICAgICAgIH0sIDQ1MDApOwogICAgICB9IGVsc2UgewogICAgICAgIHRoYXQubG9hZGluZyA9IGZhbHNlOwogICAgICB9CgogICAgICB2YXIgY3VycmVudCA9IGJvb2submF2aWdhdGlvbiAmJiBib29rLm5hdmlnYXRpb24uZ2V0KHNlY3Rpb24uaHJlZik7CiAgICAgIHRoYXQuY3VycmVudENoYXBlcklkeCA9IHNlY3Rpb24uaW5kZXg7CgogICAgICBpZiAodGhhdC5jaGFwdGVyLmhyZWYgIT0gY3VycmVudC5ocmVmKSB7CiAgICAgICAgdGhhdC5jaGFuZ2VUeXBlID0gInR1cm5QYWdlIjsKICAgICAgICB0aGF0LmNoYXB0ZXIgPSBjdXJyZW50OwogICAgICB9CgogICAgICB2YXIgbXFsID0gd2luZG93Lm1hdGNoTWVkaWEoIihvcmllbnRhdGlvbjogcG9ydHJhaXQpIik7CiAgICAgIHZhciBpZnJhbWUgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZSgiaWZyYW1lIilbMF0uY29udGVudFdpbmRvdy5kb2N1bWVudDsKICAgICAgdmFyIHZpZXdwb3J0ID0gaWZyYW1lLmdldEVsZW1lbnRzQnlUYWdOYW1lKCJodG1sIilbMF07CiAgICAgIHZhciBjb250YWluZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgidmlld2VyIikuZmlyc3RFbGVtZW50Q2hpbGQ7CiAgICAgIHZhciBzdGFydFNjcm9sbExlZnQ7CiAgICAgIHZhciBwYWdlV2lkdGggPSB3aW5kb3cuaW5uZXJXaWR0aDsgLy8g6aG16Z2i5a695bqmCgogICAgICB2YXIgbWF4V2lkdGggPSBwYWdlV2lkdGggLyAyOwogICAgICB2YXIgc3RhcnRYLCBzdGFydFk7CiAgICAgIHZhciBpbml0aWFsUG9zID0gMDsgLy8g5omL5oyH5oyJ5LiL55qE5bGP5bmV5L2N572uCgogICAgICB2YXIgbW92ZUxlbmd0aCA9IDA7IC8vIOaJi+aMh+W9k+WJjea7keWKqOeahOi3neemuwoKICAgICAgdmFyIGRpcmVjdGlvbiA9ICdsZWZ0JzsgLy8g5ruR5Yqo55qE5pa55ZCRCgogICAgICB2YXIgaXNNb3ZlID0gZmFsc2U7IC8vIOaYr+WQpuWPkeeUn+W3puWPs+a7keWKqAoKICAgICAgdmFyIHN0YXJ0VCA9IDA7IC8vIOiusOW9leaJi+aMh+aMieS4i+WOu+eahOaXtumXtAoKICAgICAgdmFyIGlzVG91Y2hFbmQgPSB0cnVlOyAvLyDmoIforrDlvZPliY3mu5HliqjmmK/lkKbnu5PmnZ8o5omL5oyH5bey56a75byA5bGP5bmVKQoKICAgICAgdmFyIHRocm90dGxlVGltZSA9IDA7CiAgICAgIHZhciBsYXN0U2Nyb2xsLCB0b3RhbFBhZ2VzOwogICAgICB0aGF0LmN1cnJlbnRQYWdlID0gMDsgLy8gbGV0IGxvY2F0aW9uID0gdmlld01hbmFnZXIuY3VycmVudExvY2F0aW9uKCk7CiAgICAgIC8vIHRoYXQuY3VycmVudFBhZ2UgPSBsb2NhdGlvblswXS5wYWdlc1swXTsgCgogICAgICBpZiAobXFsLm1hdGNoZXMpIHsKICAgICAgICB0aGlzLm1xbCA9ICIwIjsKICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLm1xbCA9ICIxIjsKICAgICAgfQoKICAgICAgaWYgKG1xbC5tYXRjaGVzKSB7CiAgICAgICAgLy8g5omL5oyH5pS+5Zyo5bGP5bmV5LiKCiAgICAgICAgdmlld3BvcnQuYWRkRXZlbnRMaXN0ZW5lcigndG91Y2hzdGFydCcsIGZ1bmN0aW9uIChlKSB7CiAgICAgICAgICBzdGFydFNjcm9sbExlZnQgPSBjb250YWluZXIuc2Nyb2xsTGVmdDsKICAgICAgICAgIHZhciBsb2NhdGlvbiA9IHZpZXdNYW5hZ2VyLmN1cnJlbnRMb2NhdGlvbigpOwogICAgICAgICAgdG90YWxQYWdlcyA9IGxvY2F0aW9uWzBdLnRvdGFsUGFnZXM7IC8vdGhhdC5jdXJyZW50UGFnZSA9IGxvY2F0aW9uWzBdLnBhZ2VzWzBdOyAgCiAgICAgICAgICAvL3RvdWNoc3RhcnTkuI50b3VjaGVuZOeahOa1j+iniOWZqOm7mOiupOihjOS4uuS4jeiDvemYu+atou+8jAogICAgICAgICAgLy8g5aaC5p6c6Zi75q2i55qE6K+d5YiZ5rWP6KeI5Zmo5peg5rOV6K6h566X6K+l6IqC54K55YaF55qE54K55Ye7562J5YW25LuW5LqL5Lu2CiAgICAgICAgICAvL2UucHJldmVudERlZmF1bHQoKTsKICAgICAgICAgIC8vIOWNleaJi+aMh+inpuaRuOaIluiAheWkmuaJi+aMh+WQjOaXtuinpuaRuO+8jOemgeatouesrOS6jOS4quaJi+aMh+W7tui/n+aTjeS9nOS6i+S7tgoKICAgICAgICAgIGlmIChlLnRvdWNoZXMubGVuZ3RoID09PSAxIHx8IGlzVG91Y2hFbmQpIHsKICAgICAgICAgICAgdmFyIHRvdWNoID0gZS50b3VjaGVzWzBdOwogICAgICAgICAgICBzdGFydFggPSB0b3VjaC5wYWdlWDsKICAgICAgICAgICAgc3RhcnRZID0gdG91Y2gucGFnZVk7CiAgICAgICAgICAgIGxhc3RTY3JvbGwgPSAwOwogICAgICAgICAgICBzdGFydFQgPSArbmV3IERhdGUoKTsgLy8g6K6w5b2V5omL5oyH5oyJ5LiL55qE5byA5aeL5pe26Ze0CgogICAgICAgICAgICBpc01vdmUgPSBmYWxzZTsgLy8g5piv5ZCm5Lqn55Sf5ruR5YqoCgogICAgICAgICAgICBpc1RvdWNoRW5kID0gZmFsc2U7IC8vIOW9k+WJjea7keWKqOW8gOWniwogICAgICAgICAgfQogICAgICAgIH0sIHsKICAgICAgICAgIHBhc3NpdmU6IGZhbHNlCiAgICAgICAgfSk7IC8vIOaJi+aMh+WcqOWxj+W5leS4iua7keWKqO+8jOmhtemdoui3n+maj+aJi+aMh+enu+WKqAoKICAgICAgICB2aWV3cG9ydC5hZGRFdmVudExpc3RlbmVyKCd0b3VjaG1vdmUnLCBmdW5jdGlvbiAoZSkgewogICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpOyAvL+eUqOS6jumikee5gea7keWKqOmYsuaKlgogICAgICAgICAgLy8gdmFyIG5vdyA9IG5ldyBEYXRlKCkuZ2V0VGltZSgpOwogICAgICAgICAgLy8gaWYoIXRocm90dGxlVGltZSkgdGhyb3R0bGVUaW1lPW5vdzsKICAgICAgICAgIC8vIGlmKG5vdy10aHJvdHRsZVRpbWU8MjApIHJldHVybjsKICAgICAgICAgIC8vIHRocm90dGxlVGltZSA9IG5vdzsKICAgICAgICAgIC8vIOWmguaenOW9k+WJjea7keWKqOW3sue7k+adn++8jOS4jeeuoeWFtuS7luaJi+aMh+aYr+WQpuWcqOWxj+W5leS4iumDveemgeatouivpeS6i+S7tgoKICAgICAgICAgIGlmIChpc1RvdWNoRW5kKSByZXR1cm47CiAgICAgICAgICB2YXIgdG91Y2ggPSBlLnRvdWNoZXNbMF07IC8vY29udGFpbmVyIHNjcm9sbOaUueWPmOaXtnRvdWNoLnBhZ2VY5Lmf5Lya6Lef552A5Y+Y77yM5omA5Lul6ZyA6KaB5YeP5o6J5a655Zmo5rua5Yqo55qE6Led56a76I635Y+W55yf5q2j55qE5omL5oyH56e75Yqo6Led56a744CCCgogICAgICAgICAgdmFyIHNjcm9sbHRlbXAgPSBjb250YWluZXIuc2Nyb2xsTGVmdCAtIHN0YXJ0U2Nyb2xsTGVmdDsKICAgICAgICAgIHZhciBkZWx0YVggPSB0b3VjaC5wYWdlWCAtIHN0YXJ0WCAtIHNjcm9sbHRlbXA7CiAgICAgICAgICBkaXJlY3Rpb24gPSBkZWx0YVggPiAwID8gJ3JpZ2h0JyA6ICdsZWZ0JzsgLy8g5Yik5pat5omL5oyH5ruR5Yqo55qE5pa55ZCRCiAgICAgICAgICAvLyBpZih0aGF0LmNoYXB0ZXIuaHJlZj09dGhhdC50b2NbMF0uaHJlZiYmZGlyZWN0aW9uPT0ncmlnaHQnJiZjdXJyZW50UGFnZT09MSkgcmV0dXJuOwoKICAgICAgICAgIGlzTW92ZSA9IHRydWU7CiAgICAgICAgICBtb3ZlTGVuZ3RoID0gZGVsdGFYOwogICAgICAgICAgc2Nyb2xsUGFnZS5jYWxsKHZpZXdwb3J0LCBtb3ZlTGVuZ3RoLCBlKTsgLy/lpoLmnpzmu5Hliqjot53nprvotoXov4fmnIDlpKfot53nprvliJnnv7vpobUKCiAgICAgICAgICBpZiAoTWF0aC5hYnMobW92ZUxlbmd0aCkgPj0gbWF4V2lkdGgpIHsKICAgICAgICAgICAgdGhyb3R0bGVUaW1lID0gMDsKICAgICAgICAgICAgdHVyblBhZ2UuY2FsbCh2aWV3cG9ydCwgbW92ZUxlbmd0aCk7CiAgICAgICAgICB9CiAgICAgICAgfSwgewogICAgICAgICAgcGFzc2l2ZTogZmFsc2UKICAgICAgICB9KTsgLy8g5omL5oyH56a75byA5bGP5bmV5pe277yM6K6h566X5pyA57uI6ZyA6KaB5YGc55WZ5Zyo5ZOq5LiA6aG1CgogICAgICAgIHZpZXdwb3J0LmFkZEV2ZW50TGlzdGVuZXIoJ3RvdWNoZW5kJywgZnVuY3Rpb24gKGUpIHsKICAgICAgICAgIGlmICghaXNNb3ZlKSB7CiAgICAgICAgICAgIGlzVG91Y2hFbmQgPSB0cnVlOwogICAgICAgICAgICBpZiAoZS50YXJnZXQudGFnTmFtZSA9PSAiQSIgfHwgZS50YXJnZXQucGFyZW50Tm9kZS50YWdOYW1lID09ICJBIikgcmV0dXJuOwogICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7CiAgICAgICAgICAgIHRoYXQucG9wdXBTaG93ID0gdHJ1ZTsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgfQoKICAgICAgICAgIHRocm90dGxlVGltZSA9IDA7CiAgICAgICAgICB2YXIgdHJhbnNsYXRlID0gMDsgLy8g6K6h566X5omL5oyH5Zyo5bGP5bmV5LiK5YGc55WZ55qE5pe26Ze0CgogICAgICAgICAgdmFyIGRlbHRhVCA9ICtuZXcgRGF0ZSgpIC0gc3RhcnRUOyAvLyDlj5HnlJ/kuobmu5HliqjvvIzlubbkuJTlvZPliY3mu5Hliqjkuovku7bmnKrnu5PmnZ8KCiAgICAgICAgICBpZiAoaXNNb3ZlICYmICFpc1RvdWNoRW5kKSB7CiAgICAgICAgICAgIGlzVG91Y2hFbmQgPSB0cnVlOyAvLyDmoIforrDlvZPliY3lrozmlbTnmoTmu5Hliqjkuovku7blt7Lnu4/nu5PmnZ8KICAgICAgICAgICAgLy8g5L2/55So5Yqo55S76L+H5rih6K6p6aG16Z2i5ruR5Yqo5Yiw5pyA57uI55qE5L2N572uCgogICAgICAgICAgICBpZiAoZGVsdGFUIDwgMzAwKSB7CiAgICAgICAgICAgICAgLy8g5aaC5p6c5YGc55WZ5pe26Ze05bCP5LqOMzAwbXMs5YiZ6K6k5Li65piv5b+r6YCf5ruR5Yqo77yM5peg6K665ruR5Yqo6Led56a75piv5aSa5bCR77yM6YO95YGc55WZ5Yiw5LiL5LiA6aG1CiAgICAgICAgICAgICAgdHVyblBhZ2UuY2FsbCh2aWV3cG9ydCwgbW92ZUxlbmd0aCk7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgLy8g5aaC5p6c5ruR5Yqo6Led56a75bCP5LqO5bGP5bmV55qENTAl77yM5YiZ6YCA5Zue5Yiw5LiK5LiA6aG1CiAgICAgICAgICAgICAgaWYgKE1hdGguYWJzKG1vdmVMZW5ndGgpIDwgbWF4V2lkdGgpIHsKICAgICAgICAgICAgICAgIC8vIOaJp+ihjOa7keWKqO+8jOiuqemhtemdouaBouWkjQogICAgICAgICAgICAgICAgc2Nyb2xsUGFnZS5jYWxsKHZpZXdwb3J0LCAwKTsKICAgICAgICAgICAgICAgIGlzVG91Y2hFbmQgPSB0cnVlOwogICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAvLyDlpoLmnpzmu5Hliqjot53nprvlpKfkuo7lsY/luZXnmoQ1MCXvvIzliJnnv7vpobUKICAgICAgICAgICAgICAgIHR1cm5QYWdlLmNhbGwodmlld3BvcnQsIG1vdmVMZW5ndGgpOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0sIHsKICAgICAgICAgIHBhc3NpdmU6IGZhbHNlCiAgICAgICAgfSk7CiAgICAgIH0KCiAgICAgIGZ1bmN0aW9uIHR1cm5QYWdlKG1vdmVMZW5ndGgpIHsKICAgICAgICBpc1RvdWNoRW5kID0gdHJ1ZTsKICAgICAgICB0aGlzLnN0eWxlLndlYmtpdFRyYW5zZm9ybSA9ICd0cmFuc2xhdGUzZCgwLCAwLCAwKSc7CgogICAgICAgIGlmIChkaXJlY3Rpb24gPT09ICJsZWZ0IikgewogICAgICAgICAgaWYgKGJvb2sucGFja2FnZS5tZXRhZGF0YS5kaXJlY3Rpb24gPT09ICJydGwiKSB7CiAgICAgICAgICAgIHJlbmRpdGlvbi5wcmV2KG1vdmVMZW5ndGgpOyAvL3RoYXQuY3VycmVudFBhZ2UtLTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHJlbmRpdGlvbi5uZXh0KG1vdmVMZW5ndGgpOyAvL3RoYXQuY3VycmVudFBhZ2UrKzsKICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgewogICAgICAgICAgaWYgKHRoYXQuY3VycmVudFBhZ2UgPT0gMSAmJiBib29rLnBhY2thZ2UubWV0YWRhdGEuZGlyZWN0aW9uICE9ICJydGwiICYmIHRoYXQuY3VycmVudENoYXBlcklkeCA8PSAyKSByZXR1cm47IC8v56ys5LiA6aG156aB5q2i57un57ut5ZCR5YmNCgogICAgICAgICAgaWYgKGJvb2sucGFja2FnZS5tZXRhZGF0YS5kaXJlY3Rpb24gPT09ICJydGwiKSB7CiAgICAgICAgICAgIHJlbmRpdGlvbi5uZXh0KG1vdmVMZW5ndGgpOyAvL3RoYXQuY3VycmVudFBhZ2UrKzsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHJlbmRpdGlvbi5wcmV2KG1vdmVMZW5ndGgpOyAvL3RoYXQuY3VycmVudFBhZ2UtLTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0gLy8g6aG16Z2i5bmz56e7CgoKICAgICAgZnVuY3Rpb24gc2Nyb2xsUGFnZSh0cmFuc2xhdGUsIHR5cGUpIHsKICAgICAgICBpZiAodGhhdC5jdXJyZW50UGFnZSA9PSAxICYmIGRpcmVjdGlvbiA9PT0gInJpZ2h0IiB8fCB0aGF0LmN1cnJlbnRQYWdlID09IHRvdGFsUGFnZXMgJiYgZGlyZWN0aW9uID09PSAibGVmdCIpIHsKICAgICAgICAgIHRoaXMuc3R5bGUud2Via2l0VHJhbnNmb3JtID0gJ3RyYW5zbGF0ZTNkKCcgKyB0cmFuc2xhdGUgKyAncHgsIDAsIDApJzsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgY29udGFpbmVyLnNjcm9sbExlZnQgPSBzdGFydFNjcm9sbExlZnQgLSB0cmFuc2xhdGU7CiAgICAgICAgfQogICAgICB9CiAgICB9KTsKICAgIHJlbmRpdGlvbi5vbigicmVsb2NhdGVkIiwgZnVuY3Rpb24gKGxvY2F0aW9ucykgewogICAgICAvL2NvbnNvbGUubG9nKCJyZWxvY2F0ZWQgbG9jYXRpb24iLGxvY2F0aW9ucyk7CiAgICAgIC8vIFdoZW4gbmF2aWdhdGluZyB0byB0aGUgbmV4dC9wcmV2aW91cyBwYWdlCiAgICAgIC8vbGV0IHByb2dyZXNzID0gYm9vay5sb2NhdGlvbnMucGVyY2VudGFnZUZyb21DZmkobG9jYXRpb25zLnN0YXJ0LmNmaSk7CiAgICAgIC8vIGNvbnNvbGUubG9nKCdQcm9ncmVzczonLCBwcm9ncmVzcyk7IC8vIFRoZSAlIG9mIGhvdyBmYXIgYWxvbmcgaW4gdGhlIGJvb2sgeW91IGFyZQogICAgICAvLyBjb25zb2xlLmxvZygnQ3VycmVudCBQYWdlOicsYm9vay5sb2NhdGlvbnMubG9jYXRpb25Gcm9tQ2ZpKGxvY2F0aW9ucy5zdGFydC5jZmkpKTsKICAgICAgLy8gY29uc29sZS5sb2coJ1RvdGFsIFBhZ2VzOicsYm9vay5sb2NhdGlvbnMudG90YWwpOwogICAgICB0aGF0LnBhZ2VBbmltYXRpb25DbGFzcyA9ICJmYWRlb3V0IjsKICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7CiAgICAgICAgdmFyIGxvY2F0aW9uID0gdmlld01hbmFnZXIuY3VycmVudExvY2F0aW9uKCk7CiAgICAgICAgdGhhdC5jdXJyZW50UGFnZSA9IGxvY2F0aW9uWzBdLnBhZ2VzWzBdOyAvLyB0aGF0LmN1cnJlbnRQYWdlIC0gMTsKCiAgICAgICAgdmFyIHRvdGFsID0gYm9vay5sb2NhdGlvbnMudG90YWw7CgogICAgICAgIGlmICh0aGF0LmxvY2F0aW9uTG9hZGluZyAmJiB0b3RhbCA8IDcwKSB7CiAgICAgICAgICAvL+WKoOi9veS4re+8jOS4lOWImuW8gOWni+WKoOi9veeahOaXtuWAme+8jOWmguaenOS8sOeul+W3sue7j+Wkp+S6jjcw6aG15LqG77yM5Lmf5bCd6K+V5LiA5LiLCiAgICAgICAgICB0aGF0LnBhZ2VUZXh0ID0gIiI7CiAgICAgICAgICB0aGF0LnBhZ2VQcm9jZXNzID0gMDsKICAgICAgICAgIHRoYXQucGFnZUFuaW1hdGlvbkNsYXNzID0gIiI7CiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQoKICAgICAgICB2YXIgcHJvZ3Jlc3MgPSBib29rLmxvY2F0aW9ucy5wZXJjZW50YWdlRnJvbUNmaShsb2NhdGlvbnMuc3RhcnQuY2ZpKTsKICAgICAgICB0aGF0LnBhZ2VQcm9jZXNzID0gcGFyc2VJbnQocHJvZ3Jlc3MgKiAxMDApOwogICAgICAgIGlmICh0b3RhbCA8IHRoYXQuYmVnaW5CYXNlUGFnZSArIGxvY2F0aW9uWzBdLnRvdGFsUGFnZXMpIHRvdGFsID0gdGhhdC5iZWdpbkJhc2VQYWdlICsgbG9jYXRpb25bMF0udG90YWxQYWdlczsgLy8gbGV0IHNob3dwYWdlID0gdGhhdC5iZWdpbkJhc2VQYWdlICsgdGhhdC5jdXJyZW50UGFnZTsKICAgICAgICAvLyBsZXQgY2FscGFnZSA9IGJvb2subG9jYXRpb25zLmxvY2F0aW9uRnJvbUNmaShsb2NhdGlvbnMuc3RhcnQuY2ZpKTsKICAgICAgICAvLyBjb25zb2xlLmxvZygnc2hvd3BhZ2U6Jywgc2hvd3BhZ2UpOyAgCiAgICAgICAgLy8gY29uc29sZS5sb2coJ2NhbHBhZ2U6JywgY2FscGFnZSk7IAogICAgICAgIC8vaWYgKGNhbHBhZ2U+dG90YWwpIHRvdGFsPWNhbHBhZ2U7CiAgICAgICAgLy/mnInpk77mjqXot7PovaznmoTml7blgJnvvIzov5nmmK9jdXJyZW50UGFnZeaYr+S4jeWvueeahAogICAgICAgIC8vIGlmICggTWF0aC5hYnMoY2FscGFnZSAtIHNob3dwYWdlKT4xICl7CiAgICAgICAgLy8gICAgIHRoYXQuY3VycmVudFBhZ2UgPSBjYWxwYWdlIC0gc2hvd3BhZ2U7CiAgICAgICAgLy8gICAgIHNob3dwYWdlID0gY2FscGFnZTsKICAgICAgICAvLyB9CgogICAgICAgIHZhciBzaG93cGFnZSA9IHRoYXQuYmVnaW5CYXNlUGFnZSArIHRoYXQuY3VycmVudFBhZ2U7IC8vaWYgKHNob3dwYWdlPnRvdGFsKSBzaG93cGFnZT10b3RhbDsKICAgICAgICAvL3RoYXQucGFnZVRleHQgPSBzaG93cGFnZSAgKyAgIi8iICsgdG90YWw7CgogICAgICAgIHRoYXQucGFnZVRleHQgPSBzaG93cGFnZTsKICAgICAgICB0aGF0LnBhZ2VBbmltYXRpb25DbGFzcyA9ICIiOwogICAgICB9LCA0MDApOwogICAgfSk7CiAgICByZW5kaXRpb24ub24oImxheW91dCIsIGZ1bmN0aW9uIChsYXlvdXQpIHsvLyAgIGNvbnNvbGUubG9nKCJsYXlvdXQiLCBsYXlvdXQpOwogICAgfSk7CiAgICByZW5kaXRpb24ub24oImxvY2F0aW9uQ2hhbmdlZCIsIGZ1bmN0aW9uIChvYmopIHsvLyBpbmRleCAobnVtYmVyKQogICAgICAvLyBocmVmIChzdHJpbmcpCiAgICAgIC8vIHN0YXJ0IChFcHViQ0ZJKQogICAgICAvLyBlbmQgKEVwdWJDRkkpCiAgICAgIC8vIHBlcmNlbnRhZ2UgKG51bWJlcikKICAgICAgLy8gICBjb25zb2xlLmxvZygibG9jYXRpb25DaGFuZ2VkIiwgb2JqKTsKICAgIH0pOwogICAgYm9vay5sb2FkZWQubmF2aWdhdGlvbi50aGVuKGZ1bmN0aW9uICh0b2MpIHsKICAgICAgdGhhdC5jaGFwdGVyID0gdG9jLnRvY1swXTsKICAgICAgdGhhdC50b2MgPSB0b2MudG9jOwogICAgfSk7CiAgfSwKICBkZXN0cm95ZWQ6IGZ1bmN0aW9uIGRlc3Ryb3llZCgpIHsKICAgIGJvb2suZGVzdHJveSgpOwogIH0sCiAgbW91bnRlZDogZnVuY3Rpb24gbW91bnRlZCgpIHt9LAogIGNyZWF0ZWQ6IGZ1bmN0aW9uIGNyZWF0ZWQoKSB7fQp9Ow=="},{"version":3,"sources":["book.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n  <div>\n    <div id=\"reader-overlay\"></div>\n\n    <van-popup v-model=\"showLeftDrawer\" position=\"left\" :style=\"{ width: '80%',height:'100%' }\">\n      <van-tabs type=\"card\">\n        <van-tab title=\"目录\">\n          <bookmenu v-bind:menuList=\"toc\" v-bind:currentMenu=\"chapter\" @change=\"changeChapter\"></bookmenu>\n        </van-tab>\n        <!--    <van-tab title=\"书签\">内容 2</van-tab>\n              <van-tab title=\"笔记\">内容 3</van-tab>\n              -->\n      </van-tabs>\n\n    </van-popup>\n\n    <van-popup v-model=\"popupShow\" position=\"top\" :style=\"{ height: '30%' }\" class=\"reader-tool\">\n      <div>\n        <van-row class=\"tool-row\">\n          <van-col span=\"4\">亮度</van-col>\n          <van-col span=\"16\">\n            <van-slider v-model=\"light\" @change=\"onLightChange\" />\n          </van-col>\n        </van-row>\n        <van-row class=\"tool-row\">\n          <van-col span=\"4\">字号</van-col>\n          <van-col span=\"16\">\n            <van-stepper v-model=\"fontSize\" @change=\"onFontSizeChange\" min=\"10\" max=\"24\" input-width=\"40px\" button-size=\"32px\" step=\"2\" disable-input />\n          </van-col>\n        </van-row>\n\n      </div>\n\n    </van-popup>\n\n    <div v-if=\"loading\" class=\"loading-overlay\">\n      <img v-if=\"firstLoading\" id=\"CoverImg\" :src=\"coverimg\" />\n      <div v-if=\"firstLoading\" style=\"color:gray;position:absolute;bottom:12px;width:100%;text-align:center;height:20px;\">加载中...</div>\n      <van-loading color=\"#1989fa\" />\n    </div>\n\n    <div style=\"height: 100vh\">\n      <van-nav-bar v-bind:title=\"chapter.label\" left-text=\"\" right-text=\"章节\" @click-right=\"onClickRight\"></van-nav-bar>\n      <div id=\"viewer\">\n        <div style=\"position: absolute;left:0;font-size: 50px;z-index: 1234;top: 50%;width:50px;height:50px\" @click=\"prevPage()\" v-if=\"mql==1 || mqlFlage== true\">\n          <img src=\"../assets/left.png\" alt=\"\" style=\"width:100%;height:100%\">\n        </div>\n        <div style=\"position: absolute;right:0;font-size: 50px;z-index: 1234;top: 50%;width:50px;height:50px\" @click=\"nextPage()\" v-if=\"mql==1 || mqlFlage==true\"><img src=\"../assets/right.png\" alt=\"\" style=\"width:100%;height:100%\"></div>\n      </div>\n    </div>\n\n    <div id=\"page-overlay\" :class=\"pageAnimationClass\">{{ pageText }}</div>\n    <div id=\"page-overlay-bar\">\n      <div id=\"page-overlay-process\" :style=\"{ height:'3px', backgroundColor:'red' ,width : pageProcess + '%'}\">\n      </div>\n    </div>\n\n    <div class=\"errorMask\" v-if=\"maskFlag\">{{errorMaskText}}</div>\n  </div>\n\n</template>\n<style scoped>\n.errorMask {\n  width: 100%;\n  height: 100%;\n  font-size: 40px;\n  font-weight: bold;\n  text-align: center;\n  padding-top: 20px;\n  position: fixed !important;\n  top: 0;\n  left: 0;\n  background: #fff;\n  z-index: 10001;\n  letter-spacing: 2px;\n}\n.fadeout {\n  -webkit-animation: fadeout 0.6s linear 0s normal 1 forwards;\n  animation: fadeout 0.6s linear 0s normal 1 forwards;\n}\n\n@-webkit-keyframes fadeout {\n  0% {\n    opacity: 1;\n  }\n  100% {\n    opacity: 0;\n  }\n}\n@keyframes fadeout {\n  0% {\n    opacity: 1;\n  }\n  100% {\n    opacity: 0;\n  }\n}\n\n#page-overlay {\n  position: absolute;\n  bottom: 6px;\n  text-align: right;\n  height: 12px;\n  left: 0;\n  right: 5px;\n  z-index: 1000;\n  font-size: 10px;\n}\n#page-overlay-bar {\n  position: absolute;\n  bottom: 3px;\n  height: 2px;\n  left: 0;\n  right: 0;\n  z-index: 1000;\n  background-color: gray;\n}\n\n#CoverImg {\n  width: 90%;\n  padding-top: 5%;\n}\n.loading-overlay {\n  position: absolute;\n  top: 0px;\n  bottom: 0px;\n  left: 0;\n  right: 0;\n  z-index: 10000;\n\n  text-align: center;\n  background-color: white;\n}\n.tool-row {\n  /*height: 40px;*/\n  text-align: center;\n  line-height: 40px;\n}\n.van-popup > div {\n  padding: 10px;\n}\n.van-slider {\n  margin: 20px;\n}\n#reader-overlay {\n  position: absolute;\n  top: 0;\n  bottom: 0;\n  right: 0;\n  left: 0;\n  z-index: 10000;\n  background-color: rgba(0, 0, 0, 0);\n  pointer-events: none;\n}\n.backImage {\n  display: inline-block;\n  width: 30px;\n  height: 30px;\n  border-radius: 30px;\n  margin-top: 5px;\n  border: 1px solid #dfdfdf;\n}\n.bg-timg4 {\n  background: url(\"/readerImages/css_sprites.png\") -10px -10px;\n}\n.bg-timg3 {\n  background: url(\"/readerImages/css_sprites.png\") -70px -10px;\n}\n.bg-timg1 {\n  background: url(\"/readerImages/css_sprites.png\") -10px -70px;\n}\n.bg-timg {\n  background: url(\"/readerImages/css_sprites.png\") -70px -70px;\n}\n</style>\n<script>\nimport { Image, Tab, Tabs, Loading, NavBar, CellGroup, Cell, Card, RadioGroup, Radio, Popup, Progress, Row, Col, Slider, Stepper } from 'vant';\nimport bookmenu from '@/components/bookmenu';\nimport Vue from 'vue';\nimport Epub from 'epubjs';\nimport axios from 'axios';\nVue.use(NavBar).use(Loading).use(Card)\n  .use(RadioGroup).use(Radio).use(CellGroup)\n  .use(Cell).use(Tabs).use(Tab).use(Popup).use(Progress)\n  .use(Row).use(Col).use(Slider).use(Stepper).use(Image);\nvar book, rendition;\nexport default {\n  name: 'book',\n  components: {\n    bookmenu: bookmenu\n  },\n  data() {\n    return {\n      publicPath: process.env.BASE_URL,\n      book: null,\n      beginBasePage: 2,\n      pageText: \"\",\n      pageProcess: 0,\n      currentPage: 1,\n      currentChaperIdx: 2,\n      rendition: null,\n      chapter: {},\n      changeType: \"menu\",\n      firstLoad: true,\n      loading: true,\n      popupShow: false,\n      showLeftDrawer: false,\n      light: 100,\n      locationLoading: true,\n      firstLoading: true,\n      maskFlag: false,\n      errorMaskText: \"\",\n      fontSize: 14,\n      backImage: \"\",\n      toc: [],\n      backImageList: [\n        { class: \"bg-timg\", backImagesrc: \"readerImages/timg_big.jpg\" },\n        { class: \"bg-timg1\", backImagesrc: \"readerImages/timg1_big.jpg\" },\n        { class: \"bg-timg3\", backImagesrc: \"readerImages/timg3_big.jpg\" },\n        { class: \"bg-timg4\", backImagesrc: \"\" },\n      ],\n      readerStyle: {\n        light: 100,\n        fontSize: 14,\n        backImage: \"\"\n      },\n      pageAnimationClass: \"\",\n      coverimg: \"\",\n      mql: \"\",\n      mqlFlage: false\n    }\n  },\n  watch: {\n    toc: {\n      handler: function (oldVal, newVal) {\n        // console.log(newVal)\n      },\n      deep: true\n    },\n    chapter: function (val) {\n      if (this.changeType == \"menu\")\n        rendition.display(val.href);\n    },\n    fontSize: function (val) {\n      this.onFontSizeChange(val);\n    },\n    light: function (val) {\n      this.onLightChange(val);\n    },\n    backImage: function (val) {\n      this.onBackImageChange(val);\n    },\n    mql: function (val) {\n      this.mql = val;\n      localStorage.setItem(\"mql\", this.mql)\n    }\n  },\n  methods: {\n    // 点击下一页\n    nextPage() {\n      rendition.next();\n    },\n    // 点击上一页\n    prevPage() {\n      if (this.currentPage == 1 && book.package.metadata.direction != \"rtl\" && this.currentChaperIdx <= 2) return; //第一页禁止继续向前\n      rendition.prev();\n    },\n    onClickLeft() {\n      window.history.back(-1);\n      // book\n    },\n    onClickRight() {\n      this.showLeftDrawer = true;\n    },\n    onLightChange(val) {\n      var overlay = document.getElementById(\"reader-overlay\");\n      overlay.style.backgroundColor = \"rgba(0,0,0,\" + (0.5 - val / 200) + \")\";\n      this.readerStyle.light = val;\n    },\n    onFontSizeChange(val) {\n      // 判断横屏竖屏展示不同字体大小\n      var mql = window.matchMedia(\"(orientation: portrait)\");\n      if (mql.matches) {\n        // 竖屏\n        // this.fontSize = 15;\n        // this.readerStyle.fontSize = 15;\n        this.mql = \"0\";\n      } else {\n        // 横屏\n        // this.fontSize = 22;\n        // this.readerStyle.fontSize = 22;\n        this.mql = \"1\";\n      }\n      var iframeDoc = document.getElementsByTagName(\"iframe\")[0].contentWindow.document;\n      var fontSizeStyle = iframeDoc.getElementById(\"fontSize\");\n      if (!fontSizeStyle) {\n        fontSizeStyle = iframeDoc.createElement('style');\n        fontSizeStyle.id = \"fontSize\";\n        fontSizeStyle.type = 'text/css';\n        fontSizeStyle.innerHTML = \"p,div{ font-size:\" + val + \"px }\";\n        iframeDoc.getElementsByTagName('HEAD').item(0).appendChild(fontSizeStyle);\n      } else {\n        fontSizeStyle.innerHTML = \"p,div{ font-size:\" + val + \"px }\";\n      }\n      if (this.readerStyle.fontSize != val) {\n        this.readerStyle.fontSize = val;\n        // this.locationLoading = true;\n        // let that = this;\n        // book.locations.generate(666).then(function(location) { // This promise will take a little while to return (About 20 seconds or so for Moby Dick)\n        //     that.locationLoading = false;\n        //     that.pageText = (that.beginBasePage + that.currentPage) + \"/\" + book.locations.total;\n        // });\n      }\n    },\n    onBackImageChange(val) {\n      var iframeDoc = document.getElementsByTagName(\"iframe\")[0].contentWindow.document;\n      var bdoy = iframeDoc.getElementsByTagName(\"body\")[0];\n      bdoy.style.backgroundImage = val;\n      this.readerStyle.backImage = val;\n    },\n    changeBackImage(value) {\n      if (value.backImagesrc)\n        this.backImage = \"url('\" + this.publicPath + value.backImagesrc + \"')\";\n      else\n        this.backImage = \"\";\n    },\n    updateStyle() {\n      this.onLightChange(this.readerStyle.light);\n      this.onBackImageChange(this.readerStyle.backImage);\n      this.onFontSizeChange(this.readerStyle.fontSize);\n    },\n    changeChapter(chapter) {\n      this.changeType = \"menu\";\n      this.showLeftDrawer = false;\n      this.chapter = chapter;\n    },\n  },\n  beforeCreate: function () {\n    // ajax()  \n    document.title = \"图书阅读\";\n    var that = this;\n    var bookfile = this.$route.params.pathMatch;\n    var paramValue = bookfile.split(\"/\");\n    if (paramValue.length < 3) {\n      that.$nextTick(function () {\n        that.maskFlag = true;\n        //todo 参数错误\n        that.errorMaskText = \"参数错误\";\n      })\n      return;\n    }\n    var token = paramValue[2];\n    if (token.indexOf(\"t=\") == -1) {\n      //校验token  \"https://data.lilun.cn/REST/api/checkepubToken/token=\" + token\n      axios\n        .get(\"http://192.168.1.218:8080/REST/api/checkepubToken?token=\" + token)\n        .then(res => {\n          if (!res) {\n            that.$nextTick(function () {\n              that.maskFlag = true;\n              that.errorMaskText = \"无效token\";\n            })\n            return;\n          }\n        });\n    }\n    bookfile = paramValue[0] + \"/\" + paramValue[1];\n    var bookoption = {};\n    if (!/.epub$/.test(bookfile) && bookfile != undefined) {\n      bookoption.openAs = 'directory';\n    }\n    book = new Epub(bookfile, bookoption);\n    rendition = book.renderTo(\"viewer\", {\n      width: \"100%\"\n    });\n    book.ready.then(function () {\n      that.coverimg = book.cover;\n      return book.locations.generate(719); // Generates CFI for every X characters (Characters per/page)\n      // }\n    }).then(function (locations) { // This promise will take a little while to return (About 20 seconds or so for Moby Dick)\n      that.locationLoading = false;\n      let location = viewManager.currentLocation();\n      let p = location[0].pages[0];\n      that.pageText = that.beginBasePage;\n      that.pageAnimationClass = \"\";\n      that.beginBasePage = that.beginBasePage - p;\n    });\n    var viewManager;\n    rendition.on(\"started\", function () {\n      viewManager = rendition.manager;\n      viewManager.on(\"beforeCreateView\", function (section) {\n        that.loading = true;\n      })\n      viewManager.on(\"afterCreateView\", function (view) {\n        view.hooks.content.register(function (iframe) {\n          that.updateStyle();\n        })\n      })\n    })\n    rendition.on(\"rendered\", function (section) {\n      if (viewManager.currentLocation()[0].pages.length >= 2) {\n        that.mqlFlage = !that.mqlFlage\n        localStorage.setItem(\"mql\", \"1\")\n      } else {\n        that.mqlFlage = false\n        localStorage.setItem(\"mql\", \"0\")\n      }\n      // mqlFlage\n      if (!that.locationLoading) {\n        let location = viewManager.currentLocation();\n        let p = location[0].pages[0];\n        that.beginBasePage = book.locations.locationFromCfi(rendition.currentLocation().start.cfi) - p;\n      }\n      if (that.firstLoading) {\n        //location（为了分页的页码计算） 还在计算中的话，稍等一会儿在关闭loading页面\n        setTimeout(function () { that.loading = false; that.firstLoading = false }, 4500);\n      } else {\n        that.loading = false;\n      }\n      let current = book.navigation && book.navigation.get(section.href);\n      that.currentChaperIdx = section.index;\n      if (that.chapter.href != current.href) {\n        that.changeType = \"turnPage\";\n        that.chapter = current;\n      }\n\n      var mql = window.matchMedia(\"(orientation: portrait)\");\n      var iframe = document.getElementsByTagName(\"iframe\")[0].contentWindow.document;\n      var viewport = iframe.getElementsByTagName(\"html\")[0];\n      var container = document.getElementById(\"viewer\").firstElementChild;\n      var startScrollLeft;\n      var pageWidth = window.innerWidth; // 页面宽度\n      var maxWidth = pageWidth / 2;\n      var startX, startY;\n      var initialPos = 0;  // 手指按下的屏幕位置\n      var moveLength = 0;  // 手指当前滑动的距离\n      var direction = 'left'; // 滑动的方向\n      var isMove = false; // 是否发生左右滑动\n      var startT = 0; // 记录手指按下去的时间\n      var isTouchEnd = true; // 标记当前滑动是否结束(手指已离开屏幕)\n      var throttleTime = 0;\n      var lastScroll, totalPages;\n      that.currentPage = 0;\n      // let location = viewManager.currentLocation();\n      // that.currentPage = location[0].pages[0]; \n      if (mql.matches) {\n        this.mql = \"0\"\n      } else {\n        this.mql = \"1\"\n      }\n      if (mql.matches) {\n        // 手指放在屏幕上\n        viewport.addEventListener('touchstart', function (e) {\n          startScrollLeft = container.scrollLeft;\n          let location = viewManager.currentLocation();\n          totalPages = location[0].totalPages;\n          //that.currentPage = location[0].pages[0];  \n          //touchstart与touchend的浏览器默认行为不能阻止，\n          // 如果阻止的话则浏览器无法计算该节点内的点击等其他事件\n          //e.preventDefault();\n          // 单手指触摸或者多手指同时触摸，禁止第二个手指延迟操作事件\n          if (e.touches.length === 1 || isTouchEnd) {\n            var touch = e.touches[0];\n            startX = touch.pageX;\n            startY = touch.pageY;\n            lastScroll = 0;\n            startT = + new Date(); // 记录手指按下的开始时间\n            isMove = false; // 是否产生滑动\n            isTouchEnd = false; // 当前滑动开始\n          }\n        }, { passive: false });\n        // 手指在屏幕上滑动，页面跟随手指移动\n        viewport.addEventListener('touchmove', function (e) {\n          e.preventDefault();\n          //用于频繁滑动防抖\n          // var now = new Date().getTime();\n          // if(!throttleTime) throttleTime=now;\n          // if(now-throttleTime<20) return;\n          // throttleTime = now;\n          // 如果当前滑动已结束，不管其他手指是否在屏幕上都禁止该事件\n          if (isTouchEnd) return;\n          var touch = e.touches[0];\n          //container scroll改变时touch.pageX也会跟着变，所以需要减掉容器滚动的距离获取真正的手指移动距离。\n          var scrolltemp = container.scrollLeft - startScrollLeft;\n          var deltaX = touch.pageX - startX - scrolltemp;\n\n          direction = deltaX > 0 ? 'right' : 'left'; // 判断手指滑动的方向\n          // if(that.chapter.href==that.toc[0].href&&direction=='right'&&currentPage==1) return;\n          isMove = true;\n          moveLength = deltaX;\n          scrollPage.call(viewport, moveLength, e);\n          //如果滑动距离超过最大距离则翻页\n          if (Math.abs(moveLength) >= maxWidth) {\n            throttleTime = 0;\n            turnPage.call(viewport, moveLength);\n          }\n        }, { passive: false });\n\n        // 手指离开屏幕时，计算最终需要停留在哪一页\n        viewport.addEventListener('touchend', function (e) {\n          if (!isMove) {\n            isTouchEnd = true;\n            if (e.target.tagName == \"A\" || e.target.parentNode.tagName == \"A\") return;\n            e.preventDefault();\n            that.popupShow = true;\n            return;\n          }\n          throttleTime = 0;\n          var translate = 0;\n          // 计算手指在屏幕上停留的时间\n          var deltaT = + new Date() - startT;\n          // 发生了滑动，并且当前滑动事件未结束\n          if (isMove && !isTouchEnd) {\n            isTouchEnd = true; // 标记当前完整的滑动事件已经结束\n            // 使用动画过渡让页面滑动到最终的位置\n            if (deltaT < 300) { // 如果停留时间小于300ms,则认为是快速滑动，无论滑动距离是多少，都停留到下一页\n              turnPage.call(viewport, moveLength);\n            } else {\n              // 如果滑动距离小于屏幕的50%，则退回到上一页\n              if (Math.abs(moveLength) < maxWidth) {\n                // 执行滑动，让页面恢复\n                scrollPage.call(viewport, 0);\n                isTouchEnd = true;\n              } else {\n                // 如果滑动距离大于屏幕的50%，则翻页\n                turnPage.call(viewport, moveLength);\n              }\n            }\n          }\n        }, { passive: false });\n      }\n      function turnPage(moveLength) {\n        isTouchEnd = true;\n        this.style.webkitTransform = 'translate3d(0, 0, 0)';\n        if (direction === \"left\") {\n          if (book.package.metadata.direction === \"rtl\") {\n            rendition.prev(moveLength);\n            //that.currentPage--;\n          } else {\n            rendition.next(moveLength);\n            //that.currentPage++;\n          }\n        } else {\n          if (that.currentPage == 1 && book.package.metadata.direction != \"rtl\" && that.currentChaperIdx <= 2) return; //第一页禁止继续向前\n          if (book.package.metadata.direction === \"rtl\") {\n            rendition.next(moveLength);\n            //that.currentPage++;\n          } else {\n            rendition.prev(moveLength);\n            //that.currentPage--;\n          }\n        }\n      }\n      // 页面平移\n      function scrollPage(translate, type) {\n        if (that.currentPage == 1 && direction === \"right\" || that.currentPage == totalPages && direction === \"left\") {\n          this.style.webkitTransform = 'translate3d(' + translate + 'px, 0, 0)';\n        } else {\n          container.scrollLeft = startScrollLeft - translate;\n        }\n      }\n    });\n    rendition.on(\"relocated\", function (locations) {\n      //console.log(\"relocated location\",locations);\n      // When navigating to the next/previous page\n      //let progress = book.locations.percentageFromCfi(locations.start.cfi);\n      // console.log('Progress:', progress); // The % of how far along in the book you are\n      // console.log('Current Page:',book.locations.locationFromCfi(locations.start.cfi));\n      // console.log('Total Pages:',book.locations.total);\n      that.pageAnimationClass = \"fadeout\";\n      setTimeout(\n        function () {\n          let location = viewManager.currentLocation();\n          that.currentPage = location[0].pages[0];\n          // that.currentPage - 1;\n          let total = book.locations.total;\n          if (that.locationLoading && total < 70) { //加载中，且刚开始加载的时候，如果估算已经大于70页了，也尝试一下\n            that.pageText = \"\";\n            that.pageProcess = 0;\n            that.pageAnimationClass = \"\";\n            return;\n          }\n          let progress = book.locations.percentageFromCfi(locations.start.cfi);\n          that.pageProcess = parseInt(progress * 100);\n          if (total < that.beginBasePage + location[0].totalPages) total = that.beginBasePage + location[0].totalPages;\n          // let showpage = that.beginBasePage + that.currentPage;\n          // let calpage = book.locations.locationFromCfi(locations.start.cfi);\n          // console.log('showpage:', showpage);  \n          // console.log('calpage:', calpage); \n          //if (calpage>total) total=calpage;\n          //有链接跳转的时候，这是currentPage是不对的\n          // if ( Math.abs(calpage - showpage)>1 ){\n          //     that.currentPage = calpage - showpage;\n          //     showpage = calpage;\n          // }\n          let showpage = that.beginBasePage + that.currentPage;\n          //if (showpage>total) showpage=total;\n          //that.pageText = showpage  +  \"/\" + total;\n          that.pageText = showpage;\n          that.pageAnimationClass = \"\";\n        }, 400);\n    });\n    rendition.on(\"layout\", function (layout) {\n      //   console.log(\"layout\", layout);\n    });\n    rendition.on(\"locationChanged\", function (obj) {\n      // index (number)\n      // href (string)\n      // start (EpubCFI)\n      // end (EpubCFI)\n      // percentage (number)\n      //   console.log(\"locationChanged\", obj);\n    });\n    book.loaded.navigation.then(function (toc) {\n      that.chapter = toc.toc[0];\n      that.toc = toc.toc;\n    });\n  },\n  destroyed: function () {\n    book.destroy();\n  },\n  mounted() {\n\n  },\n  created() {\n\n  }\n}\n</script>\n\n<style>\n.van-stepper__input[disabled] {\n  color: black;\n}\n</style>"],"sourceRoot":"src/views"}]}